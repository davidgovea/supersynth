this.audioLib=(function AUDIOLIB(a,s,j,J){var n=a.Float32Array||J,h=this;function d(N){var O=new n(N);O.subarray=O.subarray||O.slice;return O}h.Float32Array=d;var o=(function(){if(j.defineProperty){return j.defineProperty}else{if(j.prototype.__defineGetter__){return function(N,P,O){O.get&&N.__defineGetter__(P,O.get);O.set&&N.__defineSetter__(P,O.set)}}}}());function k(P,Q,O,N){if(o){o(P,Q,{get:function(){return O},enumerable:!!N})}else{P[Q]=O}}k(h,"__define",o);k(h,"__defineConst",k);function L(Q){var O=arguments,N=O.length,P,R;for(P=1;P<N;P++){for(R in O[P]){if(O[P].hasOwnProperty(R)){Q[R]=O[P][R]}}}return Q}k(h,"__extend",L);function r(O,Q,P){var N;for(N in O){(O.hasOwnProperty(N)||P)&&Q.call(O,O[N],N)}return O}k(h,"__enum",r);function B(P,R,Q,O,N){this.sampleRate=isNaN(P)?this.sampleRate:P;this.attack=isNaN(R)?this.attack:R;this.decay=isNaN(Q)?this.decay:Q;this.sustain=isNaN(O)?this.sustain:O;this.release=isNaN(N)?this.release:N}B.prototype={sampleRate:44100,attack:50,decay:50,sustain:1,release:50,value:0,state:3,gate:false,generate:function(){this.states[this.state].call(this);return this.value},getMix:function(){return this.value},triggerGate:function(N){this.gate=N;this.state=N?0:3},states:[function(){this.value+=1000/this.sampleRate/this.attack;if(this.value>=1){this.state=1}},function(){this.value-=1000/this.sampleRate/this.decay*this.sustain;if(this.value<=this.sustain){this.state=2}},function(){this.value=this.sustain},function(){this.value=s.max(0,this.value-1000/this.sampleRate/this.release)}]};function I(R,O,Q,S){var P=this,N=0;this.sampleRate=isNaN(R)?this.sampleRate:R;this.stepLength=isNaN(O)?this.stepLength:O;this.steps=Q||[1,0];this.attack=isNaN(S)?this.attack:S}I.prototype={sampleRate:44100,stepLength:200,steps:null,value:0,attack:0,phase:0,generate:function(){var V=this,Q=V.sampleRate/1000*V.stepLength,T=V.steps,R=Q*T.length,P,U,N,S,O;V.phase=(V.phase+1)%R;P=V.phase/R*T.length;U=P%1;P=s.floor(P);N=(P||T.length)-1;S=T[P]-T[N];O=T[P];if(U<V.attack){O-=S-S/V.attack*U}V.value=O;return O},getMix:function(){return this.value},triggerGate:function(){this.phase=0}};function l(N,O){this.sampleRate=isNaN(N)?this.sampleRate:N;this.schedule=[];this.reset(O)}l.prototype={sampleRate:44100,value:1,schedule:null,clock:0,getMix:function(){return this.value},generate:function(){var N;for(N=0;N<this.schedule.length;N++){if(this.schedule[N].t--){this.value=this.schedule[N].v;this.schedule.splice(N--,1)}}},setValue:function(N){this.schedule.push({v:N,t:~~((+new Date-this.clock)/1000*this.sampleRate)})},reset:function(N){this.value=isNaN(N)?this.value:N;this.clock=+new Date}};function K(Q,S,N){var O=this,R=0,P=0;O.sampleRate=Q;O.buffer=new d(isNaN(S)?500:S);O.bufferSize=O.buffer.length;O.feedback=isNaN(N)?0.5:N;O.pushSample=function(U){var T=O.buffer[P];R=-U+T;O.buffer[P++]=U+T*O.feedback;if(P>=O.bufferSize){P=0}return R};O.getMix=function(){return R};O.reset=function(){P=0;R=0;O.buffer=new d(O.bufferSize)}}function C(R,S,Q,P,O,N){this.reset.apply(this,arguments)}C.BiquadFilterClass=function H(){var N;for(N in H.prototype){if(H.prototype.hasOwnProperty){this[N]=this[N]}}};C.BiquadFilterClass.prototype={sampleRate:44100,sample:0,inputs:null,outputs:null,coefs:null,pushSample:function(O){var Q=this.coefs,N=this.inputs,P=this.outputs;this.sample=Q.b0*O+Q.b1*N[0]+Q.b2*N[1]-Q.a1*P[0]-Q.a2*P[1];N.pop();N.unshift(O);P.pop();P.unshift(this.sample);return this.sample},getMix:function(){return this.sample},reset:function(R,S,Q,P,O,N){this.inputs=[0,0];this.outputs=[0,0];this.sampleRate=isNaN(R)?this.sampleRate:R;if(arguments.length>1){this.coefs={b0:S,b1:Q,b2:P,a1:O,a2:N}}}};C.LowPass=function(Z,S,U){var V=2*s.PI*S/Z,aa=s.cos(V),N=s.sin(V),T=N/(2*U),Y=(1-aa)/2,X=1-aa,W=Y,R=1+T,P=-2*aa,O=1-T;this.reset(Z,Y/R,X/R,W/R,P/R,O/R)};C.HighPass=function(Z,S,U){var V=2*s.PI*S/Z,aa=s.cos(V),N=s.sin(V),T=N/(2*U),Y=(1+aa)/2,X=-(1+aa),W=Y,R=1+T,P=-2*aa,O=1-T;this.reset(Z,Y/R,X/R,W/R,P/R,O/R)};C.AllPass=function(Z,T,U){var V=2*s.PI*T/Z,aa=s.cos(V),N=s.sin(V),S=N/(2*U),Y=1-S,X=-2*aa,W=1+S,R=W,P=X,O=Y;this.reset(Z,Y/R,X/R,W/R,P/R,O/R)};C.BandPass=function(Z,P,V){var U=2*s.PI*P/Z,aa=s.cos(U),N=s.sin(U),S=s.log(2)/2*V*U/N,T=N*(s.exp(S)-s.exp(-S))/2,Y=T,X=0,W=-T,R=1+T,Q=-2*aa,O=1-T;this.reset(Z,Y/R,X/R,W/R,Q/R,O/R)};(function(O,N){for(N=0;N<O.length;N++){O[N].prototype=new C.BiquadFilterClass()}}([C,C.LowPass,C.HighPass,C.AllPass,C.BandPass]));function t(O,Q){var N=this,P=0;N.sampleRate=O;N.resolution=Q?s.pow(2,Q-1):s.pow(2,8-1);N.pushSample=function(R){P=s.floor(R*N.resolution+0.5)/N.resolution;return P};N.getMix=function(){return P}}function b(U,R,Q,N){var V=this,P,O,T;V.delayTime=R||30;V.depth=Q||3;V.freq=N||0.1;function S(){P=new d(V.sampleRate*0.1);O=0;var X,W=P.length;for(X=0;X<W;X++){P[X]=0}}V.sampleRate=U;V.osc=new w(U,N);V.calcCoeff=S;V.pushSample=function(X){if(++O>=P.length){O=0}P[O]=X;V.osc.generate();var W=V.delayTime+V.osc.getMix()*V.depth;W*=V.sampleRate/1000;W=O-s.floor(W);while(W<0){W+=P.length}T=P[W];return T};V.getMix=function(){return T};S()}function c(S,T,N,R){var P=this,U=0,Q=0,O=0;P.sampleRate=S;P.buffer=new d(isNaN(T)?1200:T);P.bufferSize=P.buffer.length;P.feedback=isNaN(N)?0.84:N;P.damping=isNaN(R)?0.2:R;P.pushSample=function(V){U=P.buffer[Q];O=U*(1-P.damping)+O*P.damping;P.buffer[Q++]=V+O*P.feedback;if(Q>=P.bufferSize){Q=0}return U};P.getMix=function(){return U};P.reset=function(){Q=0;O=0;U=0;P.buffer=new d(P.bufferSize)}}function A(P,O,R){var N=this,Q=0;N.sampleRate=P;N.scale=O||1;N.gain=R||0.5;N.pushSample=function(S){S/=N.scale;Q=(1+N.gain)*S-N.gain*S*S*S;return Q};N.getMix=function(){return Q}}function q(P,Q,N){var O=this;O.time=isNaN(Q)?O.time:Q;O.feedback=isNaN(N)?O.feedback:N;O.reset(P)}q.prototype={sampleRate:1,bufferPos:0,buffer:null,time:1000,feedback:0,sample:0,_rstf:1,pushSample:function(P){var O=this,N=O.buffer;N[O.bufferPos++]+=P;if(O.bufferPos>O.time*O._rstf){O.bufferPos=0}O.sample=N[O.bufferPos];N[O.bufferPos]*=O.feedback;return O.sample},getMix:function(){return this.sample},resample:function(P){var N=this,O=N.time/P;N.buffer=h.Sampler.resample(N.buffer,P);N.time=P;N.bufferPos=s.round(O*N.bufferPos);return N.buffer},reset:function(P,S){var N=this,O=N.buffer,Q,R;P=isNaN(P)?N.sampleRate:P;R=N.sampleRate/P;N.buffer=new d(P*q.MAX_DELAY);N.bufferPos=s.round(R*N.bufferPos);N._rstf=1/1000*P;if(S){O=h.Sampler.resample(O,R);for(Q=0;Q<O.length&&Q<N.buffer.length;Q++){N.buffer[Q]=O[Q]}}return N.buffer}};q.MAX_DELAY=2;function m(N){var R=new f(N,720.484),Q=new f(N,723.431),P=new f(N,1),O=0;this.gain=4;this.master=1;this.sampleRate=N;this.filters=[R,Q,P];this.pushSample=function(S){R.pushSample(S);O=R.getMix(1)*this.gain;O=s.atan(O)+O;if(O>0.4){O=0.4}else{if(O<-0.4){O=-0.4}}Q.pushSample(O);P.pushSample(Q.getMix(0));O=P.getMix(1)*this.master;return O};this.getMix=function(){return O}}function E(O,Q,R){var N=this,P=0;R=R||E.tuning;N.sampleRate=O;N.spread=Q?R.stereospread:0;N.wet=0.5;N.dry=0.55;N.inScale=R.fixedgain;N.CFs=(function(){var V=[],T=R.numcombs,S=R.initialdamp*R.scaledamp,X=R.initialroom*R.scaleroom+R.offsetroom,W=R.combs,U;for(U=0;U<T;U++){V.push(new h.CombFilter(N.sampleRate,W[U]+N.spread,X,S))}return V}());N.numCFs=N.CFs.length;N.APFs=(function(){var W=[],S=R.numallpasses,V=0.5,U=R.allpasses,T;for(T=0;T<S;T++){W.push(new E.AllPassFilter(N.sampleRate,U[T]+N.spread,V))}return W}());N.numAPFs=N.APFs.length;N.pushSample=function(V){var T=V*N.inScale,S=0,U;for(U=0;U<N.numCFs;U++){S+=N.CFs[U].pushSample(T)}for(U=0;U<N.numAPFs;U++){S=N.APFs[U].pushSample(S)}P=S*N.wet+V*N.dry;return P};N.getMix=function(){return P};N.reset=function(){var S;for(S=0;S<N.numCFs;S++){N.CFs[S].reset()}for(S=0;S<N.numAPFs;S++){N.APFs[S].reset()}P=0}}E.tuning={numcombs:8,combs:[1116,1188,1277,1356,1422,1491,1557,1617],numallpasses:4,allpasses:[556,441,341,225],fixedgain:0.015,scalewet:3,scaledry:2,scaledamp:0.4,scaleroom:0.28,offsetroom:0.7,initialroom:0.5,initialdamp:0.5,initialwet:1/3,initialdry:0,initialwidth:1,initialmode:0,freezemode:0.5,stereospread:23};E.AllPassFilter=function(Q,R,N){var O=this,S=0,P=0;O.sampleRate=Q;O.buffer=new d(isNaN(R)?500:R);O.bufferSize=O.buffer.length;O.feedback=isNaN(N)?0.5:N;O.pushSample=function(U){var T=O.buffer[P];S=-U+T;O.buffer[P++]=U+T*O.feedback;if(P>=O.bufferSize){P=0}return S};O.getMix=function(){return S};O.reset=function(){P=0;S=0;O.buffer=new d(O.bufferSize)}};function y(N,O){this.sampleRate=isNaN(N)?this.sampleRate:N;this.gain=isNaN(O)?this.gain:O}y.prototype={sampleRate:44100,gain:1,sample:0,pushSample:function(N){this.sample=N*this.gain;return this.sample},getMix:function(){return this.sample}};function f(S,O,Z,X){var aa=this,U=[0,0,0,0],N,Q,Y,P,W=s.sin,R=s.min,T=s.pow;aa.cutoff=!O?20000:O;aa.resonance=!Z?0.1:Z;aa.samplerate=S;aa.type=X||0;function V(){N=2*W(s.PI*R(0.25,aa.cutoff/(aa.samplerate*2)));Q=R(2*(1-T(aa.resonance,0.25)),R(2,2/N-N*0.5))}aa.pushSample=function(ab){if(Y!==aa.cutoff||P!==aa.resonance){V();Y=aa.cutoff;P=aa.resonance}U[3]=ab-Q*U[2];U[0]=U[0]+N*U[2];U[1]=U[3]-U[0];U[2]=N*U[1]+U[2];U[3]=ab-Q*U[2];U[0]=U[0]+N*U[2];U[1]=U[3]-U[0];U[2]=N*U[1]+U[2];return U[aa.type]};aa.getMix=function(ab){return U[ab||aa.type]}}function M(S,P,Z){var aa=this,X=0,R=0,U=s.PI*2,W,O,N,V,Y,Q;aa.cutoff=!P?20000:P;aa.resonance=!Z?1:Z;aa.samplerate=S;function T(){W=U*aa.cutoff/aa.samplerate;O=1-W/(2*(aa.resonance+0.5/(1+W))+W-2);N=O*O;V=N+1-2*s.cos(W)*O}aa.pushSample=function(ab){if(Y!==aa.cutoff||Q!==aa.resonance){T();Y=aa.cutoff;Q=aa.resonance}X+=(ab-R)*V;R+=X;X*=N;return R};aa.getMix=function(){return R};T()}function w(O,P){var N=this;N.frequency=isNaN(P)?440:P;N.waveTable=new d(1);N.sampleRate=O;N.waveShapes=N.waveShapes.slice(0)}(function(P,Q,O,N){O=w.prototype={sampleRate:1,frequency:440,phase:0,phaseOffset:0,pulseWidth:0.5,fm:0,waveShape:"sine",_p:0,generate:function(){var R=this,T=+R.frequency,S=R.pulseWidth,U=R.phase;T+=T*R.fm;R.phase=(U+T/R.sampleRate/2)%1;U=(R.phase+R.phaseOffset)%1;R._p=U<S?U/S:(U-S)/(1-S)},getMix:function(){return this[this.waveShape]()},getPhase:function(){return this._p},reset:function(R){this.phase=this._p=isNaN(R)?0:R},setWavetable:function(R){this.waveTable=R;return true},sine:function(){return s.sin(this._p*P)},triangle:function(){return this._p<0.5?4*this._p-1:3-4*this._p},square:function(){return this._p<0.5?-1:1},sawtooth:function(){return 1-this._p*2},invSawtooth:function(){return this._p*2-1},pulse:function(){return this._p<0.5?this._p<0.25?this._p*8-1:1-(this._p-0.25)*8:-1},wavetable:function(){return h.Sampler.interpolate(this.wavetable,this._p*this.wavetable.length)},waveShapes:[]};for(N=0;N<Q.length;N++){O[N]=O[Q[N]];O.waveShapes.push(O[N])}w.WaveShape=function(S,R){if(R){this.prototype[S]=R}return this.prototype[S]};w.createMixWave=function(S,V){var R=V.length,U,T;return this.WaveShape(S,function(){U=0;for(T=0;T<R;T++){U+=this[V[T].shape]()*V[T].mix}return U})}}(s.PI*2,["sine","triangle","pulse","sawtooth","invSawtooth","square"]));function D(O,P){var N=this;N.voices=[];N.sampleRate=O;N.pitch=isNaN(P)?440:N.pitch}D.prototype={sampleRate:1,pitch:440,delayStart:0,delayEnd:0,maxVoices:1/0,sampleSize:0,voices:null,sample:null,samples:null,data:null,noteOn:function(T,R){T=isNaN(T)?this.pitch:T;var O=this,S=T/O.pitch,Q=O.sampleRate,U=Q*O.delayStart,N=O.sampleSize-Q*O.delayEnd-1,P={f:T,p:U,s:S,l:N,v:isNaN(R)?1:R};O.voices.push(P);while(O.voices.length>O.maxVoices){N=O.voices.shift();N.onend&&N.onend()}return P},generate:function(){var N=this.voices,O,P;for(O=0;O<N.length;O++){P=N[O];P.p+=P.s;P.p>P.l&&N.splice(O--,1)&&P.onend&&P.onend()}},getMix:function(Q){var N=this.voices,P=0,O;Q=Q||0;if(this.samples[Q]){for(O=0;O<N.length;O++){P+=D.interpolate(this.samples[Q],N[O].p)*N[O].v}}return P},load:function(R,Q){var N=this,O=N.samples=D.deinterleave(R.data,R.channelCount),P;if(Q){for(P=0;P<O.length;P++){O[P]=D.resample(O[P],R.sampleRate,N.sampleRate)}}N.sample=R.data;N.samples=O;N.data=R;N.sampleSize=O[0].length}};(function(){function N(O,P){if(O&&P){N[O]=P}else{if(O&&N[O] instanceof Function){D.interpolate=N[O]}}return N[O]}D.interpolation=N;N("linear",function(O,S){var R=s.floor(S),Q=R+1,P=S-R;Q=Q<O.length?Q:0;return O[R]*(1-P)+O[Q]*P});N("nearest",function(O,P){return P>=O.length-0.5?O[0]:O[s.round(P)]});N("linear")}());D.resample=function(U,N,X,Y,P){var T=arguments.length,R=T===2?N:T===3?N/X:Y/N*P/X,S=U.length,O=s.ceil(S/R),W=new d(O),V,Q;for(V=0,Q=0;V<S;V+=R){W[Q++]=D.interpolate(U,V)}return W};D.deinterleave=function(O,S){var N=O.length,R=N/S,P=[],Q,T;for(Q=0;Q<S;Q++){P[Q]=new d(R);for(T=0;T<R;T++){P[Q][T]=O[T*S+Q]}}return P};D.interleave=function(P){var R=P.length,O=P[0].length,N=new d(O*R),Q,S;for(Q=0;Q<R;Q++){for(S=0;S<O;S++){N[Q+S*R]=P[Q][S]}}return N};D.mix=function(P){var O=[].slice.call(arguments,1),N,Q,R;for(R=0;R<O.length;R++){N=s.max(P.length,O[R].length);for(Q=0;Q<N;Q++){P[Q]+=O[R][Q]}}return P};function x(P,Q,O){var N=this;N.notes=[];N.sampleRate=P;N.noteTime=isNaN(Q)?250:Q;N.noteLength=P*0.001*N.noteTime;N.zero=new d(N.noteLength);N.cb=O}x.prototype={pos:0,looping:false,generate:function(){var N=this,P,O;if((N.pos+=1)===N.noteLength){P=N.notes,O=P.shift();if(N.looping){P.push(O)}N.pos=0;N.cb()}},getMix:function(){var N=this,O=N.notes[0]||N.zero;return O[N.pos]},addNote:function(O){var N=this,R=N.noteLength,Q=new d(R),P=0;for(P=0;P<R;P++){Q[P]=O(P)}N.notes.push(Q)},addBuffer:function(N){this.notes.push(N)},getNoteLength:function(){return this.noteLength},getNoteCount:function(){return this.notes.length-1},setLooping:function(N){this.looping=(typeof N==="undefined")?true:N},reset:function(){this.notes=[];this.pos=0}};(function(N){function S(Z){var ab,aa=Z.length,Y={};for(ab=0;ab<aa;ab++){Y[Z[ab]]=true}return Y}var V=S([256,512,1024,2048,4096,8192,16384]),O=S([48000,44100,22050]),X=String.fromCharCode;function W(ad,ac,ab,aa){var Z=W.devices,Y;for(Y in Z){if(Z.hasOwnProperty(Y)&&Z[Y].enabled){try{return new Z[Y](ad,ac,ab,aa)}catch(ae){}}}throw"No audio device available."}function P(Y){this.boundTo=Y;this.buffers=[];Y.activeRecordings.push(this)}P.prototype={add:function(Y){this.buffers.push(Y)},clear:function(){this.buffers=[]},stop:function(){var Y=this.boundTo.activeRecordings,Z;for(Z=0;Z<Y.length;Z++){if(Y[Z]===this){Y.splice(Z--,1)}}},join:function(){var ac=0,ad=0,aa=this.buffers,Y,ae,ab,Z=aa.length;for(ab=0;ab<Z;ab++){ac+=aa[ab].length}Y=new d(ac);for(ab=0;ab<Z;ab++){for(ae=0;ae<aa[ab].length;ae++){Y[ad+ae]=aa[ab][ae]}ad+=aa[ab].length}return Y}};function U(Y){this.type=Y}U.prototype={record:function(){return new P(this)},recordData:function(Z){var ab=this.activeRecordings,aa,Y=ab.length;for(aa=0;aa<Y;aa++){ab[aa].add(Z)}},writeBuffers:function(aa){var Z=this.buffers,Y=aa.length,ab,ad,ac,ae;if(Z){for(ac=0;ac<Z.length;ac++){ab=Z[ac];ad=ab.length;for(ae=0;ae<Y&&ae<ad;ae++){aa[ae]+=ab[ae]}Z[ac]=ab.subarray(ae);ac>=ad&&Z.splice(ac--,1)}}},writeBuffer:function(Z){var Y=this.buffers=this.buffers||[];Y.push(Z);return Y.length}};function T(ai,af,Z,ak){ak=O[ak]?ak:44100;Z=V[Z]?Z:ak/2;var am=this,ab=0,aj=null,ah=new Audio(),ag,ae,ad,ac,Y;function al(at,ao){var ar,aq,an;if(T.backgroundWork){if(window.MozBlobBuilder){an=new MozBlobBuilder();an.append('setInterval(function(){ postMessage("tic"); }, '+ao+");");aq=window.URL.createObjectURL(an.getBlob());ar=new Worker(aq);ar.onmessage=function(){at()};return function(){ar.terminate();window.URL.revokeObjectURL(aq)}}aq=an=+new Date+"";function ap(au){if(au.source===window&&au.data===aq&&an<+new Date){an=+new Date+ao;at()}window.postMessage(aq,"*")}window.addEventListener("message",ap,true);window.postMessage(aq,"*");return function(){window.removeEventListener("message",ap)}}else{ar=setInterval(at,ao);return function(){clearInterval(ar)}}}function aa(){if(aj){ag=ah.mozWriteAudio(aj);ab+=ag;if(ag<aj.length){aj=aj.subarray(ag);return aj}aj=null}ae=ah.mozCurrentSampleOffset();ad=Number(ae+Z*af-ab)+0;if(ad>0){ac=new d(ad);ai&&ai(ac,am.channelCount);am.writeBuffers(ac);am.recordData(ac);ag=ah.mozWriteAudio(ac);if(ag<ac.length){aj=ac.subarray(ag)}ab+=ag}}ah.mozSetup(af,ak);Y=al(aa,20);this.kill=function(){Y()};this.activeRecordings=[];this.sampleRate=ak;this.channelCount=af;this.type="moz"}T.enabled=true;T.backgroundWork=false;T.prototype=new U("moz");function R(af,ad,ab,aa){aa=O[aa]?aa:44100;ab=V[ab]?ab:4096;var Y=this,ac=new (window.AudioContext||webkitAudioContext)(),ae=ac.createJavaScriptNode(ab,0,ad);function Z(an){var ag=an.outputBuffer,aj=ag.numberOfChannels,al,ai,ak=ag.length,ao=ag.size,am=new J(aj),ah=new d(ak*aj);for(al=0;al<aj;al++){am[al]=ag.getChannelData(al)}af&&af(ah,aj);Y.writeBuffers(ah);Y.recordData(ah);for(al=0;al<ak;al++){for(ai=0;ai<aj;ai++){am[ai][al]=ah[al*aj+ai]}}}ae.onaudioprocess=Z;ae.connect(ac.destination);this.kill=function(){};this.activeRecordings=[];this.sampleRate=ac.sampleRate;this.channelCount=ad;this._context=ac;this._node=ae;this._callback=Z;this.type="webkit"}R.enabled=true;R.prototype=new U("webkit");function Q(ad,ac,ab,aa){aa=O[aa]?aa:44100;ab=V[ab]?bufferSize:8192;var Y=this,ae;function Z(){var af=new d(ab*ac);ad&&ad(af,Y.channelCount);Y.writeBuffers(af);Y.recordData(af)}this.kill=function(){clearInterval(ae)};this.activeRecordings=[];setInterval(Z,ab/aa*1000);this.sampleRate=aa;this.channelCount=ac;this.type="dummy"}Q.enabled=true;Q.prototype=new U("dummy");W.deviceClass=U;W.propertyEnum=S;W.devices={moz:T,webkit:R,dummy:Q};W.Recording=P;N.AudioDevice=W}(this));this.AudioDevice.createScheduled=function(R){var Q=[],N=0,O;function P(T,W){var S=T.length/W,Z=O.chunkSize,V=Z*W,Y,U,X;N=+new Date;for(U=0;U<S;U+=Z){for(Y=0;Y<Q.length;Y++){Q[Y].t-=Z;if(Q[Y].t<=0){Q[Y].f.apply(Q[Y].x,Q[Y].a);Q.splice(Y--,1)}}X=U*V;R(T.subarray(X,X+V),W)}}O=this.apply(this,[P].concat(J.prototype.splice.call(arguments,1)));O.schedule=function(U,T,S){Q.push({f:U,x:T,a:S,t:((new Date-N)*0.001*this.sampleRate)})};O.chunkSize=1;return O};(function(){function N(){var P=arguments,O=P.length,R,Q;for(Q=0;Q<O;Q++){R=P[Q];this.postMessage({type:"injection",code:R instanceof Function?"("+String(R)+").call(this);":R})}}h.AudioWorker=function(Q,S){var O=new (window.MozBlobBuilder||window.BlobBuilder)(),P,R;O.append("var audioLib = ("+String(AUDIOLIB)+"(this, Math, Object, Array));\n");for(P=0;P<h.plugins._pluginList.length;P++){O.append("("+String(h.plugins._pluginList[P])+"());\n")}S&&O.append('this.addEventListener("message",function(e){e.data&&e.data.type==="injection"&&Function(e.data.code).call(this)}, true);\n');O.append(Q instanceof Function?"("+String(Q)+").call(this);":Q);P=window.URL.createObjectURL(O.getBlob());R=new Worker(P);R._terminate=R.terminate;R.terminate=function(){window.URL.revokeObjectURL(id);return R._terminate.call(R,arguments)};if(S){R.inject=N}return R}}());(function(O,P){var W=String.fromCharCode,U=true,Q=false;function R(X,Y){return Y?W(X&255)+R(X>>8,Y-1):""}function T(X,Y){return Y?T(X>>8,Y-1)+W(255-X&255):""}function V(X,Y,Z){return Z?T(X,Y):R(X,Y)}function N(ac,ab){var X=ac.length,aa=X-1,ad=0,Z=P.pow,Y;if(ab){for(Y=0;Y<X;Y++){ad+=(255-ac.charCodeAt(Y))*Z(256,aa-Y)}}else{for(Y=0;Y<X;Y++){ad+=ac.charCodeAt(Y)*Z(256,Y)}}return ad}function S(ab,ag,aa,aj){var af=P.pow,ae=P.floor,Y=S.convertFromBinary,ah=S.convertToBinary,X=ab/8,ad=af(2,ab),ai=ad/2,ak=ai-1,ac=1/ai,Z=1/ak;return aj?aa?ag?function(al,am){al=ae(al<0?al*ai+ad:al*ak);return ah(al,X,am)}:function(al,am){return ah(ae(al*ak),X,am)}:ag?function(al,am){return ah(al<0?al+ad:al,X,am)}:function(al,am){return ah(al,X,am)}:aa?ag?function(an,am){var al=Y(an,am);return al>ak?(al-ad)*ac:al*Z}:function(am,al){return Y(am,al)*Z}:ag?function(an,am){var al=Y(an,am);return al>ak?al-ad:al}:function(am,al){return Y(am,al)}}S.convertToBinary=V;S.convertFromBinary=N;S.fromFloat32=S(32,U,U,U);S.toFloat32=S(32,U,U,Q);S.fromFloat24=S(24,U,U,U);S.toFloat24=S(24,U,U,Q);S.fromFloat16=S(16,U,U,U);S.toFloat16=S(16,U,U,Q);S.fromFloat8=S(8,U,U,U);S.toFloat8=S(8,U,U,Q);S.fromInt32=S(32,U,Q,U);S.toInt32=S(32,U,Q,Q);S.fromInt16=S(16,U,Q,U);S.toInt16=S(16,U,Q,Q);S.fromInt8=S(8,U,Q,U);S.toInt8=S(8,U,Q,Q);S.fromUint32=S(32,Q,Q,U);S.toUint32=S(32,Q,Q,Q);S.fromUint16=S(16,Q,Q,U);S.toUint16=S(16,Q,Q,Q);S.fromUint8=S(8,Q,Q,U);S.toUint8=S(8,Q,Q,Q);O.Binary=S}(this,s));(function(R,S){function T(U){this.data=U}var Q=T.prototype={read:function(V){var U=this,W=U.data.substr(0,V);U.skip(V);return W},skip:function(V){var U=this,W=U.data=U.data.substr(V);U.pointer+=V;return W.length},readBuffer:function(V,Y,aa){var W=this,Z="read"+aa+Y,ab=Y/8,U=V.length,X=0;while(W.data&&X<U){V[X++]=W[Z]()}return X}},P,O;function N(X,V,W){var U=V/8;Q["read"+X+V]=function(Y){return W(this.read(U),Y)}}for(P in S){O=/to([a-z]+)([0-9]+)/i.exec(P);O&&N(O[1],O[2],S[P])}R.Stream=T;T.newType=N}(this,this.Binary));this.PCMData=(function(N,O){function P(Q){return(typeof Q==="string"?P.decode:P.encode)(Q)}P.decodeFrame=function(T,S,Q){if(S===8){var R=new (window.Uint8Array||J)(Q.length);(new O(T)).readBuffer(R,8,"Uint");for(S=0;S<Q.length;S++){Q[S]=(R[S]-127.5)*127.5}}else{(new O(T)).readBuffer(Q,S,"Float")}return Q};P.encodeFrame=function(V,T){var R=N[(T===8?"fromUint":"fromFloat")+T],Q=V.length,U="",S;if(T===8){for(S=0;S<Q;S++){U+=R(V[S]*127.5+127.5)}}else{for(S=0;S<Q;S++){U+=R(V[S])}}return U};P.decode=function(ap,ao){var T=new O(ap),Z=T.read(4),ah=T.readUint32();T=new O(T.read(ah));var W=T.read(4),Y=T.read(4),af=T.readUint32(),Q=new O(T.read(af)),S=Q.readUint16(),ak=Q.readUint16(),an=Q.readUint32(),U=Q.readUint32(),am=Q.readUint16(),al=am/ak,X=Q.readUint16(),R,ab,ad,ai,ag,V,aj,ae={},aa={channelCount:ak,bytesPerSample:am/ak,sampleRate:U/am,chunks:ae,data:ag};function ac(){R=T.read(4);ab=T.readUint32();ai=T.read(ab);V=ae[R]=ae[R]||[];if(R==="data"){ad=~~(ab/al);ag=aa.data=new (typeof d!=="undefined"?d:J)(ad);P.decodeFrame(ai,al*8,ag)}else{V.push(ai)}ao&&(T.data?setTimeout(ac,1):ao(aa))}if(ao){T.data?ac():ao(aa)}else{while(T.data){ac()}}return aa};P.encode=function(ai,ag){var ac=N.fromUint32,aj=N.fromUint16,Z=ai.data,Q=ai.sampleRate,U=ai.channelCount||1,ae=ai.bytesPerSample||1,V=ae*8,S=U*ae,af=Q*S,T=Z.length,R=T*ae,Y=s.pow(2,V-1)-1,X=[],W="",ah,ad,aa,ab;X.push("fmt "+ac(16)+aj(1)+aj(U)+ac(Q)+ac(af)+aj(S)+aj(V));X.push("data"+ac(R)+P.encodeFrame(Z,V));ab=ai.chunks;if(ab){for(ad in ab){if(ab.hasOwnProperty(ad)){ah=ab[ad];for(aa=0;aa<ah.length;aa++){W=ah[aa];X.push(ad+ac(W.length)+W)}}}}X=X.join("");X="RIFF"+ac(X.length)+"WAVE"+X;ag&&setTimeout(function(){ag(X)},1);return X};return P}(this.Binary,this.Stream));function e(O){var N;for(N in e.prototype){if(e.prototype.hasOwnProperty(N)){this[N]=e.prototype[N]}}this.resetBuffer.apply(this,arguments)}e.prototype={bufferPos:-1,pushSample:function(N){this.bufferPos=(this.bufferPos+1)%this.buffer.length;this.bufferPos===0&&this.process(this.buffer);this.buffer[this.bufferPos]=N;return N},getMix:function(){return this.buffer[this.bufferPos]},resetBuffer:function(N){this.bufferSize=isNaN(N)?this.bufferSize:N;this.buffer=new d(this.bufferSize);this.bufferPos=-1}};this.FourierTransform=(function(){var U=s.sin,X=s.cos,W=s.sqrt,S=s.floor,T=s.pow,Q=s.log,N=s.ln2,R=s.PI,P=R*2;function V(Z,aa){var Y;for(Y in V.prototype){if(V.prototype.hasOwnProperty){this[Y]=V.prototype[Y]}}e.apply(this,[].slice.call(arguments,1));this.resetFT.apply(this,arguments)}V.prototype={resetFT:function(Z){var Y=this;Y.sampleRate=isNaN(Z)?Y.sampleRate:Z;Y.bandWidth=2/Y.bufferSize*Y.sampleRate*0.5;Y.spectrum=new d(Y.bufferSize*0.5);Y.real=new d(Y.bufferSize);Y.imag=new d(Y.bufferSize);Y.peakBand=0;Y.peak=0},getBandFrequency:function(Y){return this.bandwidth*Y+this.bandWidth*0.5},calculateSpectrum:function(){var ag=this,ad=ag.spectrum,Y=ag.imag,af=2/ag.bufferSize,ac=ag.bufferSize/2,aa,ae,ab,Z;for(Z=0;Z<ac;Z++){aa=ag.real[Z];ae=ag.imag[Z];ab=af*W(aa*aa+ae*ae);if(ab>ag.peak){ag.peakBand=Z;ag.peak=ab}ad[Z]=ab}}};function O(Y,Z){V.apply(this,arguments);this.reset()}O.prototype={sampleRate:44100,bufferSize:2048,method:"forward",reset:function(){this.resetBuffer.apply(this,arguments);this.resetFT.apply(this,arguments);this.reverseTable=new Uint32Array(this.bufferSize);var Y=1,aa=this.bufferSize>>1,Z;while(Y<this.bufferSize){for(Z=0;Z<Y;Z++){this.reverseTable[Z+Y]=this.reverseTable[Z]+aa}Y=Y<<1;aa=aa>>1}},forward:function(al){var aj=this,ac=aj.bufferSize,af=aj.reverseTable,ah=aj.real,ao=aj.imag,aq=aj.spectrum,am=S(Q(ac)/N),ak=1,ae,ag,Y,aa,ar,Z,ad,ap,an,ab,at,ai;for(an=0;an<ac;an++){ah[an]=al[af[an]];ao[an]=0}while(ak<ac){ab=-s.PI/ak;ae=X(ab);ag=U(ab);Y=1;aa=0;ai=ak*2;for(at=0;at<ak;at++){an=at;while(an<ac){ar=an+ak;Z=Y*ah[ar]+aa*ao[ar];ad=Y*ao[ar]+aa*ah[ar];ah[ar]=ah[an]-Z;ao[ar]=ao[an]-ad;ah[an]+=Z;ao[an]+=ad;an+=ai}ap=Y;Y=ap*ae-aa*ag;aa=ap*ag-aa*ae}ak=ai}return this.calculateSpectrum()},inverse:function(aj,ao){var al=this,ae=al.bufferSize,ah=al.reverseTable,aq=al.spectrum,am=1,aa=new d(ae),ab=new d(ae),ag,ai,Y,ac,ar,Z,af,ap,an,ad,at,ak;aj=aj||al.real;ao=ao||al.imag;for(an=0;an<ae;an++){ao[an]*=-1}for(an=0;an<aj.length;an++){aa[an]=aj[ah[an]];revImag[an]=ao[ah[an]]}aj=aa;ao=revImag;while(am<ae){ad=-s.PI/am;ag=X(ad);ai=U(ad);Y=1;ac=0;ak=am*2;for(at=0;at<am;at++){an=at;while(an<ae){ar=an+am;Z=Y*aj[ar]+ac*ao[ar];af=Y*ao[ar]+ac*aj[ar];aj[ar]=aj[an]-Z;ao[ar]=ao[an]-af;aj[an]+=Z;ao[an]+=af;an+=ak}ap=Y;Y=ap*ag-ac*ai;ac=ap*ai-ac*ag}am=ak}return this.calculateSpectrum()},process:function(Y){this[this.method](Y||this.buffer)}};V.FFT=O;return V}());h.ADSREnvelope=B;h.StepSequencer=I;h.UIControl=l;h.BiquadFilter=C;h.BitCrusher=t;h.Chorus=b;h.CombFilter=c;h.Compressor=A;h.Delay=q;h.Distortion=m;h.GainController=y;h.IIRFilter=f;h.LP12Filter=M;h.Reverb=E;h.Oscillator=w;h.Sampler=D;h.AudioProcessingUnit=e;function G(){}G.prototype={type:"effect",sink:true,source:true,mix:0.5,join:function(){return u.apply(0,[this].concat(J.prototype.splice.call(arguments,0)))},addPreProcessing:function(N){N.pushSample=this.pushSample;this.pushSample=function(){N.apply(this,arguments);return N.pushSample.apply(this,arguments)}},removePreProcessing:function(O){var N;while(N=this.pushSample.pushSample){if(N===O||!O){this.pushSample=N;O.pushSample=null}}}};function u(){var N=J.prototype.splice.call(arguments,0),O=N.prototype=u.prototype;for(i in O){if(O.hasOwnProperty(i)){N[i]=O[i]}}return N}(function(N){u.prototype=N;N.pushSample=function(R){var O=this,Q,P;for(P=0;P<O.length;P++){Q=O[P].mix;R=O[P].pushSample(R)*Q+R*(1-Q)}return R}}(new G()));function F(P,O,N){this.channelCount=O;this.effects=[];function Q(){P.apply(this,N)}Q.prototype=P.prototype;while(O--){this.effects.push(new Q())}}F.prototype={mix:0.5,append:function(O){var P=this,R=P.channelCount,N=O.length,Q,S;for(Q=0;Q<N;Q+=R){for(S=0;S<R;S++){O[Q+S]=P.effects[S].pushSample(O[Q+S])*P.mix+O[Q+S]*(1-P.mix)}}return O},join:function(){return BufferEffectChain.apply(0,[this].concat(J.prototype.splice.call(arguments,0)))},addPreProcessing:function(){var N;for(N=0;N<this.effects.length;N++){this.effects[N].addPreProcessing.apply(this.effects[N],arguments)}},removePreProcessing:function(){var N;for(N=0;N<this.effects.length;N++){this.effects[N].removePreProcessing.apply(this.effects[N],arguments)}},addAutomation:function(){return h.Automation.apply(h,[this].concat([].slice.call(arguments)))}};function g(){}g.prototype={type:"generator",source:true,mix:1,generatedBuffer:null,append:function(O,Q){var N=O.length,P,R;Q=Q||1;for(P=0;P<N;P+=Q){this.generate();for(R=0;R<Q;R++){O[P+R]=this.getMix(R)*this.mix+O[P+R]}}return O},addPreProcessing:function(N){N.generate=this.generate;this.generate=function(){N.apply(this,arguments);return N.generate.apply(this,arguments)}},removePreProcessing:function(O){var N;while(N=this.generate.generate){if(N===O||!O){this.generate=N;O.generate=null}}},addAutomation:function(){return h.Automation.apply(h,[this].concat([].slice.call(arguments)))},generateBuffer:function(O){this.generatedBuffer=new d(O);var N;for(N=0;N<O;N++){this.generate();this.generatedBuffer[N]=this.getMix()}}};(function(Q,O){function N(R){return new h.BufferEffect(this,R,[].slice.call(arguments,1))}function P(S,T,R){if(T){R=R||T.prototype;P[S]=T;var U=T.prototype=new G();U.name=U.fxid=S;P[S].createBufferBased=N;for(S in R){if(R.hasOwnProperty(S)){U[S]=R[S]}}}return P[S]}h.effects=P;for(O=0;O<Q.length;O++){P(Q[O],h[Q[O]],h[Q[O]].prototype)}P("BiquadHighPassFilter",C.HighPass);P("BiquadLowPassFilter",C.LowPass);P("BiquadAllPassFilter",C.AllPass);P("BiquadBandPassFilter",C.BandPass);P("FFT",h.FourierTransform.FFT);h.FFT=h.FourierTransform.FFT}(["BiquadFilter","BitCrusher","Chorus","CombFilter","Compressor","Delay","Distortion","GainController","IIRFilter","LP12Filter","Reverb"]));(function(P,N){function O(R,S,Q){if(S){Q=Q||S.prototype;O[R]=S;var T=S.prototype=new g();T.name=T.fxid=R;for(R in Q){if(Q.hasOwnProperty(R)){T[R]=Q[R]}}}return O[R]}h.generators=O;for(N=0;N<P.length;N++){O(P[N],h[P[N]],h[P[N]].prototype)}}(["Oscillator","Sampler","ADSREnvelope","StepSequencer","UIControl"]));function z(N,O){var P=N[0].toUpperCase()+N.substr(1).toLowerCase();z[N]=O;if(O.decode){h.Sampler.prototype["load"+P]=function(Q){this.load.apply(this,[z[N].decode(Q)].concat([].slice.call(arguments,1)))}}if(O.encode){h.AudioDevice.Recording.prototype["to"+P]=function(Q){return z[N].encode({data:this.join(),sampleRate:this.boundTo.sampleRate,channelCount:this.boundTo.channelCount,bytesPerSample:Q})}}return O}z("wav",h.PCMData);function p(N,O){p[N]=O;p._pluginList.push({plugin:O,name:N})}k(p,"_pluginList",[],false);function v(Q,R,N,O,P){if(!Q.automation){Q.automation=[];if(Q.type==="generator"){Q.append=v.generatorAppend}else{Q.append=v.effectAppend}}var N={parameter:R,automation:N,amount:isNaN(O)?1:O,type:P||"modulation"};Q.automation.push(N);return N}v.generatorAppend=function(T,Q){var W=this,R=T.length,S=W.automation.length,N=[],U,O,P,V;Q=Q||1;for(P=0;P<S;P++){N.push(W[W.automation[P].parameter])}for(U=0;U<R;U+=Q){for(P=0;P<S;P++){W[W.automation[P].parameter]=N[P]}for(P=0;P<S;P++){V=W.automation[P];switch(V.type){case"modulation":W[V.parameter]*=V.amount*V.automation.generatedBuffer[U];break;case"addition":W[V.parameter]+=V.amount*V.automation.generatedBuffer[U];break;case"substraction":W[V.parameter]-=V.amount*V.automation.generatedBuffer[U];break;case"additiveModulation":W[V.parameter]+=W[V.parameter]*V.amount*V.automation.generatedBuffer[U];break;case"substractiveModulation":W[V.parameter]-=W[V.parameter]*V.amount*V.automation.generatedBuffer[U];break;case"assignment":W[V.parameter]=V.amount*V.automation.generatedBuffer[U];break;case"absoluteAssignment":W[V.parameter]=s.abs(V.amount*V.automation.generatedBuffer[U]);break}}W.generate();for(O=0;O<Q;O++){T[U+O]=W.getMix(O)*W.mix+T[U+O]}}for(P=0;P<S;P++){W[W.automation[P].parameter]=N[P]}return T};v.effectAppend=function(T){var X=this,N=X.channelCount,R=T.length,S=X.automation.length,O=[],U,P,Q,V,W;for(Q=0;Q<S;Q++){O.push([]);for(P=0;P<N;P++){O[Q].push(X.effects[P][X.automation[Q].parameter])}}for(U=0;U<R;U+=N){for(P=0;P<N;P++){for(Q=0;Q<S;Q++){W=X.automation[Q];X.effects[P][W.parameter]=O[Q][P];switch(W.type){case"modulation":X.effects[P][W.parameter]*=W.amount*W.automation.generatedBuffer[U];break;case"addition":X.effects[P][W.parameter]+=W.amount*W.automation.generatedBuffer[U];break;case"substraction":X.effects[P][W.parameter]-=W.amount*W.automation.generatedBuffer[U];break;case"additiveModulation":X.effects[P][W.parameter]+=X.effects[P][W.parameter]*W.amount*W.automation.generatedBuffer[U];break;case"substractiveModulation":X.effects[P][W.parameter]-=X.effects[P][W.parameter]*W.amount*W.automation.generatedBuffer[U];break;case"assignment":X.effects[P][W.parameter]=W.amount*W.automation.generatedBuffer[U];break;case"absoluteAssignment":X.effects[P][W.parameter]=s.abs(W.amount*W.automation.generatedBuffer[U]);break}}T[U+P]=X.effects[P].pushSample(T[U+P])*X.mix+T[U+P]*(1-X.mix)}}for(Q=0;Q<S;Q++){for(P=0;P<N;P++){X.effects[P][X.automation[Q].parameter]=O[Q][P]}}return T};h.Automation=v;h.EffectChain=u;h.EffectClass=G;h.BufferEffect=F;h.GeneratorClass=g;h.codecs=h.Codec=z;h.plugins=p;h.version="0.4.7";return h}).call(typeof exports==="undefined"?{}:this,this.window||global,Math,Object,Array);